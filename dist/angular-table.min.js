// author:   Samuel Mueller 
 // version: 2.0.0 
 // license:  MIT 
 // homepage: http://github.com/samu/angular-table

(function(){var t,e,a,r,n,i,s,g,l,u;angular.module("angular-table",[]),t=class{constructor(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.customContent=e.customContent,this.attributes=e.attributes)}createElement(){return angular.element(document.createElement("th"))}renderTitle(t){return t.html(this.customContent||this.title)}renderAttributes(t){var e,a,r,n,i;if(this.customContent){for(i=[],a=0,r=(n=this.attributes).length;a<r;a++)e=n[a],i.push(t.attr(e.name,e.value));return i}}renderSorting(t){var e;if(this.sortable)return t.attr("ng-click",`change($event, '${this.attribute}')`),(e=angular.element("<i style='margin-left: 10px;'></i>")).attr("ng-class",`'fas fa-' + getSortIcon('${this.attribute}', predicate, descending)`),t.append(e)}renderWidth(t){return t.attr("width",this.width)}renderHtml(){var t;return t=this.createElement(),this.renderTitle(t),this.renderAttributes(t),this.renderSorting(t),this.renderWidth(t),t}},l=class{constructor(t){this.configObjectName=t,this.itemsPerPage=`${this.configObjectName}.itemsPerPage`,this.sortContext=`${this.configObjectName}.sortContext`,this.fillLastPage=`${this.configObjectName}.fillLastPage`,this.maxPages=`${this.configObjectName}.maxPages`,this.currentPage=`${this.configObjectName}.currentPage`,this.orderBy=`${this.configObjectName}.orderBy`,this.paginatorLabels=`${this.configObjectName}.paginatorLabels`}},r=class{constructor(t,e,a){this.scope=t,this.configurationVariableNames=e,this.listName=a}getList(){return this.scope.$eval(this.listName)}getItemsPerPage(){return this.scope.$eval(this.configurationVariableNames.itemsPerPage)||10}getCurrentPage(){return this.scope.$eval(this.configurationVariableNames.currentPage)||0}getMaxPages(){return this.scope.$eval(this.configurationVariableNames.maxPages)||void 0}getSortContext(){return this.scope.$eval(this.configurationVariableNames.sortContext)||"global"}setCurrentPage(t){return this.scope.$eval(`${this.configurationVariableNames.currentPage}=${t}`)}getOrderBy(){return this.scope.$eval(this.configurationVariableNames.orderBy)||"orderBy"}getPaginatorLabels(){var t;return t={stepBack:"‹",stepAhead:"›",jumpBack:"«",jumpAhead:"»",first:"Primeiro",last:"Último"},this.scope.$eval(this.configurationVariableNames.paginatorLabels)||t}},g=class{constructor(t,e){this.tableElement=t,this.attributes=e,this.id=this.attributes.id,this.config=this.attributes.atConfig,this.paginated=null!=this.attributes.atPaginated,this.list=this.attributes.atList,this.createColumnConfigurations()}capitaliseFirstLetter(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}extractWidth(t){var e;return(e=/([0-9]+px)/i.exec(t))?e[0]:""}isSortable(t){return!!/(sortable)/i.exec(t)}getInitialSorting(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw`Invalid value for initial-sorting: ${e}. Allowed values are 'asc' or 'desc'.`}}collectHeaderMarkup(t){var e,a,r,n,i;for(e={},a=0,r=(n=t.find("tr").find("th")).length;a<r;a++)i=n[a],e[(i=angular.element(i)).attr("at-attribute")]={customContent:i.html(),attributes:i[0].attributes};return e}collectBodyMarkup(t){var e,a,r,n,i,s,g,l,u,o;for(a=[],n=0,i=(s=t.find("td")).length;n<i;n++)l=s[n],e=(l=angular.element(l)).attr("at-attribute"),u=l.attr("at-title")||this.capitaliseFirstLetter(l.attr("at-attribute")),g=void 0!==l.attr("at-sortable")||this.isSortable(l.attr("class")),o=this.extractWidth(l.attr("class")),r=this.getInitialSorting(l),a.push({attribute:e,title:u,sortable:g,width:o,initialSorting:r});return a}createColumnConfigurations(){var e,a,r,n,i;for(a=this.collectHeaderMarkup(this.tableElement),e=this.collectBodyMarkup(this.tableElement),this.columnConfigurations=[],n=0,i=e.length;n<i;n++)r=e[n],this.columnConfigurations.push(new t(r,a[r.attribute]))}},n=class{setupTr(t,e){var a;return(a=t.find("tbody")).find("tr").attr("ng-repeat",e),a}},i=class extends n{constructor(t,e){super(),this.list=e,this.repeatString=`item in ${this.list} | orderBy:predicate:descending`}compile(t,e,a){return this.setupTr(t,this.repeatString)}link(){}},a=class extends n{constructor(t){super(),this.configurationVariableNames=t,this.repeatString="item in sortedAndPaginatedList"}compile(t){var e,a,r,n,i,s;for(n=this.setupTr(t,this.repeatString),i="",a=0,r=(s=t.find("td")).length;a<r;a++)s[a],i+="<td><span>&nbsp;</span></td>";(e=angular.element(document.createElement("tr"))).attr("ng-show",this.configurationVariableNames.fillLastPage),e.html(i),e.attr("ng-repeat","item in fillerArray"),n.append(e)}link(t,e,a,n){var i,s,g,l,u;return i=this.configurationVariableNames,u=new r(t,i,a.atList),g=function(t,e,a,r,n,i,s,g){var l,u;return t?(u=t,l=a*e-t.length,"global"===n?(u=g(r)(u,i,s),u=g("limitTo")(u,l),u=g("limitTo")(u,a)):(u=g("limitTo")(u,l),u=g("limitTo")(u,a),u=g(r)(u,i,s)),u):[]},s=function(t,e,a,r){var n,i,s,g,l,u,o,c,h,d;if(r=parseInt(r),t.length<=0){for(c=[],d=s=0,l=r-1;0<=l?s<=l:s>=l;d=0<=l?++s:--s)c.push(d);return c}if(e===a-1){if(0!==(i=t.length%r)){for(n=r-i-1,h=[],d=g=u=t.length,o=t.length+n;u<=o?g<=o:g>=o;d=u<=o?++g:--g)h.push(d);return h}return[]}},l=function(){var e;return t.sortedAndPaginatedList=g(u.getList(),u.getCurrentPage(),u.getItemsPerPage(),u.getOrderBy(),u.getSortContext(),t.predicate,t.descending,n),e=Math.ceil(u.getList().length/u.getItemsPerPage()),t.fillerArray=s(u.getList(),u.getCurrentPage(),e,u.getItemsPerPage())},t.$watch(i.currentPage,function(){return l()}),t.$watch(i.itemsPerPage,function(){return l()}),t.$watch(i.sortContext,function(){return l()}),t.$watchCollection(a.atList,function(){return l()}),t.$watch(`${a.atList}.length`,function(){return t.numberOfPages=Math.ceil(u.getList().length/u.getItemsPerPage()),l()}),t.$watch("predicate",function(){return l()}),t.$watch("descending",function(){return l()})}},s=class{constructor(t,e,a){this.element=t,this.tableConfiguration=e,this.configurationVariableNames=a}constructHeader(){var t,e,a,r,n;for(n=angular.element(document.createElement("tr")),e=0,a=(r=this.tableConfiguration.columnConfigurations).length;e<a;e++)t=r[e],n.append(t.renderHtml());return n}setupHeader(){var t,e;if(e=this.element.find("thead"))return t=this.constructHeader(),angular.element(e).find("tr").remove(),e.append(t)}getSetup(){return this.tableConfiguration.paginated?new a(this.configurationVariableNames):new i(this.configurationVariableNames,this.tableConfiguration.list)}compile(){return this.setupHeader(),this.setup=this.getSetup(),this.setup.compile(this.element)}setupInitialSorting(t){var e,a,r,n,i;for(i=[],a=0,r=(n=this.tableConfiguration.columnConfigurations).length;a<r;a++)if((e=n[a]).initialSorting){if(!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,i.push(t.descending="desc"===e.initialSorting)}else i.push(void 0);return i}post(t,e,a,r){return this.setupInitialSorting(t),t.change=function(e,a){return console.log(e),console.log(angular.element(e.currentTarget).find("svg")),a!==t.predicate?(angular.element(e.currentTarget).find("svg").removeClass("fa-chevron-up"),angular.element(e.currentTarget).find("svg").removeClass("fa-chevron-down"),angular.element(e.currentTarget).find("svg").addClass("fa-minus")):t.descending?(angular.element(e.currentTarget).find("svg").removeClass("fa-chevron-up"),angular.element(e.currentTarget).find("svg").addClass("fa-chevron-down"),angular.element(e.currentTarget).find("svg").removeClass("fa-minus")):(angular.element(e.currentTarget).find("svg").addClass("fa-chevron-up"),angular.element(e.currentTarget).find("svg").removeClass("fa-chevron-down"),angular.element(e.currentTarget).find("svg").removeClass("fa-minus")),t.predicate=a,t.descending=!t.descending},t.getSortIcon||(t.getSortIcon=function(e,a,r){return e!==t.predicate?"minus":r?"chevron-down":"chevron-up"}),this.setup.link(t,e,a,r)}},e=class{constructor(t=0,e=1,a=0,r=1){if(this.lowerBound=t,this.upperBound=e,this.length=r,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";this.data=this.generate(a)}generate(t){var e,a,r,n,i;for(t>this.upperBound-this.length?t=this.upperBound-this.length:t<this.lowerBound&&(t=this.lowerBound),n=[],i=e=a=t,r=parseInt(t)+parseInt(this.length)-1;a<=r?e<=r:e>=r;i=a<=r?++e:--e)n.push(i);return n}resetParameters(t,e,a){if(this.lowerBound=t,this.upperBound=e,this.length=a,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";return this.data=this.generate(this.data[0])}relocate(t){var e;return e=this.data[0]+t,this.data=this.generate(e,e+this.length)}realignGreedy(t){var e;return t<this.data[0]?(e=t,this.data=this.generate(e)):t>this.data[this.length-1]?(e=t-(this.length-1),this.data=this.generate(e)):void 0}realignGenerous(t){}},u="<div style='margin: 0px;'> <ul class='pagination'> <li class='page-item' ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' class='page-link' ng-click='stepPage(-numberOfPages)'>{{getPaginatorLabels().first}}</a> </li> <li class='page-item' ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' class='page-link' ng-click='jumpBack()'>{{getPaginatorLabels().jumpBack}}</a> </li> <li class='page-item' ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' class='page-link' ng-click='stepPage(-1)'>{{getPaginatorLabels().stepBack}}</a> </li> <li class='page-item' ng-class='{active: getCurrentPage() == page}' ng-repeat='page in pageSequence.data'> <a href='' class='page-link' ng-click='goToPage(page)' ng-bind='page + 1'></a> </li> <li class='page-item' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' class='page-link' ng-click='stepPage(1)'>{{getPaginatorLabels().stepAhead}}</a> </li> <li class='page-item' ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' class='page-link' ng-click='jumpAhead()'>{{getPaginatorLabels().jumpAhead}}</a> </li> <li class='page-item' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' class='page-link' ng-click='stepPage(numberOfPages)'>{{getPaginatorLabels().last}}</a> </li> </ul> </div>",angular.module("angular-table").directive("atTable",["$filter",function(t){return{restrict:"AC",scope:!0,compile:function(e,a,r){var n,i,u;return u=new g(e,a),n=new l(a.atConfig),(i=new s(e,u,n)).compile(),{post:function(e,a,r){return i.post(e,a,r,t)}}}}}]),angular.module("angular-table").directive("atPagination",[function(){return{restrict:"E",scope:!0,replace:!0,template:u,link:function(t,a,n){var i,s,g,u,o,c;return i=new l(n.atConfig),c=new r(t,i,n.atList),g=function(t,e,a){return t=Math.max(e,t),Math.min(a,t)},s=function(){return t.numberOfPages},u=function(e){return t.numberOfPages=e},o=function(e){var a,r;if(c.getList())return c.getList().length>0?(a=Math.ceil(c.getList().length/c.getItemsPerPage()),u(a),r=t.showSectioning()?c.getMaxPages():a,t.pageSequence.resetParameters(0,a,r),c.setCurrentPage(g(c.getCurrentPage(),0,s()-1)),t.pageSequence.realignGreedy(c.getCurrentPage())):(u(1),t.pageSequence.resetParameters(0,1,1),c.setCurrentPage(0),t.pageSequence.realignGreedy(0))},t.showSectioning=function(){return c.getMaxPages()&&s()>c.getMaxPages()},t.getCurrentPage=function(){return c.getCurrentPage()},t.getPaginatorLabels=function(){return c.getPaginatorLabels()},t.stepPage=function(e){return e=parseInt(e),c.setCurrentPage(g(c.getCurrentPage()+e,0,s()-1)),t.pageSequence.realignGreedy(c.getCurrentPage())},t.goToPage=function(t){return c.setCurrentPage(t)},t.jumpBack=function(){return t.stepPage(-c.getMaxPages())},t.jumpAhead=function(){return t.stepPage(c.getMaxPages())},t.pageSequence=new e,t.$watch(i.itemsPerPage,function(){return o()}),t.$watch(i.maxPages,function(){return o()}),t.$watch(n.atList,function(){return o()}),t.$watch(`${n.atList}.length`,function(){return o()}),o()}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t,e,a){var r;if(!(r=t.attr("at-attribute")))throw`at-implicit specified without at-attribute: ${t.html()}`;return t.append(`<span ng-bind='item.${r}'></span>`)}}}])}).call(this);