// author:   Samuel Mueller 
 // version: 2.0.0 
 // license:  MIT 
 // homepage: http://github.com/samu/angular-table

(function(){var t,e,a,i,r,n,s,g,l,o;angular.module("angular-table",[]),t=class{constructor(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.customContent=e.customContent,this.attributes=e.attributes)}createElement(){return angular.element(document.createElement("th"))}renderTitle(t){return t.html(this.customContent||this.title)}renderAttributes(t){var e,a,i,r,n;if(this.customContent){for(n=[],a=0,i=(r=this.attributes).length;a<i;a++)e=r[a],n.push(t.attr(e.name,e.value));return n}}renderSorting(t){var e;if(this.sortable)return t.attr("ng-click",`predicate = '${this.attribute}'; descending = !descending;`),(e=angular.element("<i style='margin-left: 10px;'></i>")).attr("ng-class",`getSortIcon('${this.attribute}', predicate, descending)`),t.append(e)}renderWidth(t){return t.attr("width",this.width)}renderHtml(){var t;return t=this.createElement(),this.renderTitle(t),this.renderAttributes(t),this.renderSorting(t),this.renderWidth(t),t}},l=class{constructor(t){this.configObjectName=t,this.itemsPerPage=`${this.configObjectName}.itemsPerPage`,this.sortContext=`${this.configObjectName}.sortContext`,this.fillLastPage=`${this.configObjectName}.fillLastPage`,this.maxPages=`${this.configObjectName}.maxPages`,this.currentPage=`${this.configObjectName}.currentPage`,this.orderBy=`${this.configObjectName}.orderBy`,this.paginatorLabels=`${this.configObjectName}.paginatorLabels`}},i=class{constructor(t,e,a){this.scope=t,this.configurationVariableNames=e,this.listName=a}getList(){return this.scope.$eval(this.listName)}getItemsPerPage(){return this.scope.$eval(this.configurationVariableNames.itemsPerPage)||10}getCurrentPage(){return this.scope.$eval(this.configurationVariableNames.currentPage)||0}getMaxPages(){return this.scope.$eval(this.configurationVariableNames.maxPages)||void 0}getSortContext(){return this.scope.$eval(this.configurationVariableNames.sortContext)||"global"}setCurrentPage(t){return this.scope.$eval(`${this.configurationVariableNames.currentPage}=${t}`)}getOrderBy(){return this.scope.$eval(this.configurationVariableNames.orderBy)||"orderBy"}getPaginatorLabels(){var t;return t={stepBack:"‹",stepAhead:"›",jumpBack:"«",jumpAhead:"»",first:"Primeiro",last:"Último"},this.scope.$eval(this.configurationVariableNames.paginatorLabels)||t}},g=class{constructor(t,e){this.tableElement=t,this.attributes=e,this.id=this.attributes.id,this.config=this.attributes.atConfig,this.paginated=null!=this.attributes.atPaginated,this.list=this.attributes.atList,this.createColumnConfigurations()}capitaliseFirstLetter(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}extractWidth(t){var e;return(e=/([0-9]+px)/i.exec(t))?e[0]:""}isSortable(t){return!!/(sortable)/i.exec(t)}getInitialSorting(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw`Invalid value for initial-sorting: ${e}. Allowed values are 'asc' or 'desc'.`}}collectHeaderMarkup(t){var e,a,i,r,n;for(e={},a=0,i=(r=t.find("tr").find("th")).length;a<i;a++)n=r[a],e[(n=angular.element(n)).attr("at-attribute")]={customContent:n.html(),attributes:n[0].attributes};return e}collectBodyMarkup(t){var e,a,i,r,n,s,g,l,o,u;for(a=[],r=0,n=(s=t.find("td")).length;r<n;r++)l=s[r],e=(l=angular.element(l)).attr("at-attribute"),o=l.attr("at-title")||this.capitaliseFirstLetter(l.attr("at-attribute")),g=void 0!==l.attr("at-sortable")||this.isSortable(l.attr("class")),u=this.extractWidth(l.attr("class")),i=this.getInitialSorting(l),a.push({attribute:e,title:o,sortable:g,width:u,initialSorting:i});return a}createColumnConfigurations(){var e,a,i,r,n;for(a=this.collectHeaderMarkup(this.tableElement),e=this.collectBodyMarkup(this.tableElement),this.columnConfigurations=[],r=0,n=e.length;r<n;r++)i=e[r],this.columnConfigurations.push(new t(i,a[i.attribute]))}},r=class{setupTr(t,e){var a;return(a=t.find("tbody")).find("tr").attr("ng-repeat",e),a}},n=class extends r{constructor(t,e){super(),this.list=e,this.repeatString=`item in ${this.list} | orderBy:predicate:descending`}compile(t,e,a){return this.setupTr(t,this.repeatString)}link(){}},a=class extends r{constructor(t){super(),this.configurationVariableNames=t,this.repeatString="item in sortedAndPaginatedList"}compile(t){var e,a,i,r,n,s;for(r=this.setupTr(t,this.repeatString),n="",a=0,i=(s=t.find("td")).length;a<i;a++)s[a],n+="<td><span>&nbsp;</span></td>";(e=angular.element(document.createElement("tr"))).attr("ng-show",this.configurationVariableNames.fillLastPage),e.html(n),e.attr("ng-repeat","item in fillerArray"),r.append(e)}link(t,e,a,r){var n,s,g,l,o;return n=this.configurationVariableNames,o=new i(t,n,a.atList),g=function(t,e,a,i,r,n,s,g){var l,o;return t?(o=t,l=a*e-t.length,"global"===r?(o=g(i)(o,n,s),o=g("limitTo")(o,l),o=g("limitTo")(o,a)):(o=g("limitTo")(o,l),o=g("limitTo")(o,a),o=g(i)(o,n,s)),o):[]},s=function(t,e,a,i){var r,n,s,g,l,o,u,c,h,d;if(i=parseInt(i),t.length<=0){for(c=[],d=s=0,l=i-1;0<=l?s<=l:s>=l;d=0<=l?++s:--s)c.push(d);return c}if(e===a-1){if(0!==(n=t.length%i)){for(r=i-n-1,h=[],d=g=o=t.length,u=t.length+r;o<=u?g<=u:g>=u;d=o<=u?++g:--g)h.push(d);return h}return[]}},l=function(){var e;return t.sortedAndPaginatedList=g(o.getList(),o.getCurrentPage(),o.getItemsPerPage(),o.getOrderBy(),o.getSortContext(),t.predicate,t.descending,r),e=Math.ceil(o.getList().length/o.getItemsPerPage()),t.fillerArray=s(o.getList(),o.getCurrentPage(),e,o.getItemsPerPage())},t.$watch(n.currentPage,function(){return l()}),t.$watch(n.itemsPerPage,function(){return l()}),t.$watch(n.sortContext,function(){return l()}),t.$watchCollection(a.atList,function(){return l()}),t.$watch(`${a.atList}.length`,function(){return t.numberOfPages=Math.ceil(o.getList().length/o.getItemsPerPage()),l()}),t.$watch("predicate",function(){return l()}),t.$watch("descending",function(){return l()})}},s=class{constructor(t,e,a){this.element=t,this.tableConfiguration=e,this.configurationVariableNames=a}constructHeader(){var t,e,a,i,r;for(r=angular.element(document.createElement("tr")),e=0,a=(i=this.tableConfiguration.columnConfigurations).length;e<a;e++)t=i[e],r.append(t.renderHtml());return r}setupHeader(){var t,e;if(e=this.element.find("thead"))return t=this.constructHeader(),angular.element(e).find("tr").remove(),e.append(t)}getSetup(){return this.tableConfiguration.paginated?new a(this.configurationVariableNames):new n(this.configurationVariableNames,this.tableConfiguration.list)}compile(){return this.setupHeader(),this.setup=this.getSetup(),this.setup.compile(this.element)}setupInitialSorting(t){var e,a,i,r,n;for(n=[],a=0,i=(r=this.tableConfiguration.columnConfigurations).length;a<i;a++)if((e=r[a]).initialSorting){if(!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,n.push(t.descending="desc"===e.initialSorting)}else n.push(void 0);return n}post(t,e,a,i){return this.setupInitialSorting(t),t.getSortIcon||(t.getSortIcon=function(e,a,i){return console.log("get sort icon"),e!==t.predicate?"fas fa-minus":i?"fas fa-chevron-down":"fas fa-chevron-up"}),this.setup.link(t,e,a,i)}},e=class{constructor(t=0,e=1,a=0,i=1){if(this.lowerBound=t,this.upperBound=e,this.length=i,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";this.data=this.generate(a)}generate(t){var e,a,i,r,n;for(t>this.upperBound-this.length?t=this.upperBound-this.length:t<this.lowerBound&&(t=this.lowerBound),r=[],n=e=a=t,i=parseInt(t)+parseInt(this.length)-1;a<=i?e<=i:e>=i;n=a<=i?++e:--e)r.push(n);return r}resetParameters(t,e,a){if(this.lowerBound=t,this.upperBound=e,this.length=a,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";return this.data=this.generate(this.data[0])}relocate(t){var e;return e=this.data[0]+t,this.data=this.generate(e,e+this.length)}realignGreedy(t){var e;return t<this.data[0]?(e=t,this.data=this.generate(e)):t>this.data[this.length-1]?(e=t-(this.length-1),this.data=this.generate(e)):void 0}realignGenerous(t){}},o="<div style='margin: 0px;'> <ul class='pagination'> <li class='page-item' ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' class='page-link' ng-click='stepPage(-numberOfPages)'>{{getPaginatorLabels().first}}</a> </li> <li class='page-item' ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() <= 0}'> <a class='page-link' href='' ng-click='jumpBack()'>{{getPaginatorLabels().jumpBack}}</a> </li> <li class='page-item' ng-class='{disabled: getCurrentPage() <= 0}'> <a class='page-link' href='' ng-click='stepPage(-1)'>{{getPaginatorLabels().stepBack}}</a> </li> <li class='page-item' ng-class='{active: getCurrentPage() == page}' ng-repeat='page in pageSequence.data'> <a class='page-link' href='' ng-click='goToPage(page)' ng-bind='page + 1'></a> </li> <li class='page-item' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a class='page-link' href='' ng-click='stepPage(1)'>{{getPaginatorLabels().stepAhead}}</a> </li> <li class='page-item' ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a class='page-link' href='' ng-click='jumpAhead()'>{{getPaginatorLabels().jumpAhead}}</a> </li> <li class='page-item' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a class='page-link' href='' ng-click='stepPage(numberOfPages)'>{{getPaginatorLabels().last}}</a> </li> </ul> </div>",angular.module("angular-table").directive("atTable",["$filter",function(t){return{restrict:"AC",scope:!0,compile:function(e,a,i){var r,n,o;return o=new g(e,a),r=new l(a.atConfig),(n=new s(e,o,r)).compile(),{post:function(e,a,i){return n.post(e,a,i,t)}}}}}]),angular.module("angular-table").directive("atPagination",[function(){return{restrict:"E",scope:!0,replace:!0,template:o,link:function(t,a,r){var n,s,g,o,u,c;return n=new l(r.atConfig),c=new i(t,n,r.atList),g=function(t,e,a){return t=Math.max(e,t),Math.min(a,t)},s=function(){return t.numberOfPages},o=function(e){return t.numberOfPages=e},u=function(e){var a,i;if(c.getList())return c.getList().length>0?(a=Math.ceil(c.getList().length/c.getItemsPerPage()),o(a),i=t.showSectioning()?c.getMaxPages():a,t.pageSequence.resetParameters(0,a,i),c.setCurrentPage(g(c.getCurrentPage(),0,s()-1)),t.pageSequence.realignGreedy(c.getCurrentPage())):(o(1),t.pageSequence.resetParameters(0,1,1),c.setCurrentPage(0),t.pageSequence.realignGreedy(0))},t.showSectioning=function(){return c.getMaxPages()&&s()>c.getMaxPages()},t.getCurrentPage=function(){return c.getCurrentPage()},t.getPaginatorLabels=function(){return c.getPaginatorLabels()},t.stepPage=function(e){return e=parseInt(e),c.setCurrentPage(g(c.getCurrentPage()+e,0,s()-1)),t.pageSequence.realignGreedy(c.getCurrentPage())},t.goToPage=function(t){return c.setCurrentPage(t)},t.jumpBack=function(){return t.stepPage(-c.getMaxPages())},t.jumpAhead=function(){return t.stepPage(c.getMaxPages())},t.pageSequence=new e,t.$watch(n.itemsPerPage,function(){return u()}),t.$watch(n.maxPages,function(){return u()}),t.$watch(r.atList,function(){return u()}),t.$watch(`${r.atList}.length`,function(){return u()}),u()}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t,e,a){var i;if(!(i=t.attr("at-attribute")))throw`at-implicit specified without at-attribute: ${t.html()}`;return t.append(`<span ng-bind='item.${i}'></span>`)}}}])}).call(this);