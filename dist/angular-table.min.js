// author:   Samuel Mueller 
 // version: 2.0.0 
 // license:  MIT 
 // homepage: http://github.com/samu/angular-table

(function(){var t,e,r,i,a,n,s,g,o,u;angular.module("angular-table",[]),t=class{constructor(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.customContent=e.customContent,this.attributes=e.attributes)}createElement(){return angular.element(document.createElement("th"))}renderTitle(t){return t.html(this.customContent||this.title)}renderAttributes(t){var e,r,i,a,n;if(this.customContent){for(n=[],r=0,i=(a=this.attributes).length;r<i;r++)e=a[r],n.push(t.attr(e.name,e.value));return n}}renderSorting(t){var e;if(this.sortable)return t.attr("ng-click",`predicate = '${this.attribute}'; descending = !descending;`),(e=angular.element("<i style='margin-left: 10px;'></i>")).attr("ng-class",`getSortIcon('${this.attribute}', predicate, descending)`),t.append(e)}renderWidth(t){return t.attr("width",this.width)}renderHtml(){var t;return t=this.createElement(),this.renderTitle(t),this.renderAttributes(t),this.renderSorting(t),this.renderWidth(t),t}},o=class{constructor(t){this.configObjectName=t,this.itemsPerPage=`${this.configObjectName}.itemsPerPage`,this.sortContext=`${this.configObjectName}.sortContext`,this.fillLastPage=`${this.configObjectName}.fillLastPage`,this.maxPages=`${this.configObjectName}.maxPages`,this.currentPage=`${this.configObjectName}.currentPage`,this.orderBy=`${this.configObjectName}.orderBy`,this.paginatorLabels=`${this.configObjectName}.paginatorLabels`}},i=class{constructor(t,e,r){this.scope=t,this.configurationVariableNames=e,this.listName=r}getList(){return this.scope.$eval(this.listName)}getItemsPerPage(){return this.scope.$eval(this.configurationVariableNames.itemsPerPage)||10}getCurrentPage(){return this.scope.$eval(this.configurationVariableNames.currentPage)||0}getMaxPages(){return this.scope.$eval(this.configurationVariableNames.maxPages)||void 0}getSortContext(){return this.scope.$eval(this.configurationVariableNames.sortContext)||"global"}setCurrentPage(t){return this.scope.$eval(`${this.configurationVariableNames.currentPage}=${t}`)}getOrderBy(){return this.scope.$eval(this.configurationVariableNames.orderBy)||"orderBy"}getPaginatorLabels(){var t;return t={stepBack:"‹",stepAhead:"›",jumpBack:"«",jumpAhead:"»",first:"First",last:"Last"},this.scope.$eval(this.configurationVariableNames.paginatorLabels)||t}},g=class{constructor(t,e){this.tableElement=t,this.attributes=e,this.id=this.attributes.id,this.config=this.attributes.atConfig,this.paginated=null!=this.attributes.atPaginated,this.list=this.attributes.atList,this.createColumnConfigurations()}capitaliseFirstLetter(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}extractWidth(t){var e;return(e=/([0-9]+px)/i.exec(t))?e[0]:""}isSortable(t){return!!/(sortable)/i.exec(t)}getInitialSorting(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw`Invalid value for initial-sorting: ${e}. Allowed values are 'asc' or 'desc'.`}}collectHeaderMarkup(t){var e,r,i,a,n;for(e={},r=0,i=(a=t.find("tr").find("th")).length;r<i;r++)n=a[r],e[(n=angular.element(n)).attr("at-attribute")]={customContent:n.html(),attributes:n[0].attributes};return e}collectBodyMarkup(t){var e,r,i,a,n,s,g,o,u,l;for(r=[],a=0,n=(s=t.find("td")).length;a<n;a++)o=s[a],e=(o=angular.element(o)).attr("at-attribute"),u=o.attr("at-title")||this.capitaliseFirstLetter(o.attr("at-attribute")),g=void 0!==o.attr("at-sortable")||this.isSortable(o.attr("class")),l=this.extractWidth(o.attr("class")),i=this.getInitialSorting(o),r.push({attribute:e,title:u,sortable:g,width:l,initialSorting:i});return r}createColumnConfigurations(){var e,r,i,a,n;for(r=this.collectHeaderMarkup(this.tableElement),e=this.collectBodyMarkup(this.tableElement),this.columnConfigurations=[],a=0,n=e.length;a<n;a++)i=e[a],this.columnConfigurations.push(new t(i,r[i.attribute]))}},a=class{setupTr(t,e){var r;return(r=t.find("tbody")).find("tr").attr("ng-repeat",e),r}},n=class extends a{constructor(t,e){super(),this.list=e,this.repeatString=`item in ${this.list} | orderBy:predicate:descending`}compile(t,e,r){return this.setupTr(t,this.repeatString)}link(){}},r=class extends a{constructor(t){super(),this.configurationVariableNames=t,this.repeatString="item in sortedAndPaginatedList"}compile(t){var e,r,i,a,n,s;for(a=this.setupTr(t,this.repeatString),n="",r=0,i=(s=t.find("td")).length;r<i;r++)s[r],n+="<td><span>&nbsp;</span></td>";(e=angular.element(document.createElement("tr"))).attr("ng-show",this.configurationVariableNames.fillLastPage),e.html(n),e.attr("ng-repeat","item in fillerArray"),a.append(e)}link(t,e,r,a){var n,s,g,o,u;return n=this.configurationVariableNames,u=new i(t,n,r.atList),g=function(t,e,r,i,a,n,s,g){var o,u;return t?(u=t,o=r*e-t.length,"global"===a?(u=g(i)(u,n,s),u=g("limitTo")(u,o),u=g("limitTo")(u,r)):(u=g("limitTo")(u,o),u=g("limitTo")(u,r),u=g(i)(u,n,s)),u):[]},s=function(t,e,r,i){var a,n,s,g,o,u,l,c,h,d;if(i=parseInt(i),t.length<=0){for(c=[],d=s=0,o=i-1;0<=o?s<=o:s>=o;d=0<=o?++s:--s)c.push(d);return c}if(e===r-1){if(0!==(n=t.length%i)){for(a=i-n-1,h=[],d=g=u=t.length,l=t.length+a;u<=l?g<=l:g>=l;d=u<=l?++g:--g)h.push(d);return h}return[]}},o=function(){var e;return t.sortedAndPaginatedList=g(u.getList(),u.getCurrentPage(),u.getItemsPerPage(),u.getOrderBy(),u.getSortContext(),t.predicate,t.descending,a),e=Math.ceil(u.getList().length/u.getItemsPerPage()),t.fillerArray=s(u.getList(),u.getCurrentPage(),e,u.getItemsPerPage())},t.$watch(n.currentPage,function(){return o()}),t.$watch(n.itemsPerPage,function(){return o()}),t.$watch(n.sortContext,function(){return o()}),t.$watchCollection(r.atList,function(){return o()}),t.$watch(`${r.atList}.length`,function(){return t.numberOfPages=Math.ceil(u.getList().length/u.getItemsPerPage()),o()}),t.$watch("predicate",function(){return o()}),t.$watch("descending",function(){return o()})}},s=class{constructor(t,e,r){this.element=t,this.tableConfiguration=e,this.configurationVariableNames=r}constructHeader(){var t,e,r,i,a;for(a=angular.element(document.createElement("tr")),e=0,r=(i=this.tableConfiguration.columnConfigurations).length;e<r;e++)t=i[e],a.append(t.renderHtml());return a}setupHeader(){var t,e;if(e=this.element.find("thead"))return t=this.constructHeader(),angular.element(e).find("tr").remove(),e.append(t)}getSetup(){return this.tableConfiguration.paginated?new r(this.configurationVariableNames):new n(this.configurationVariableNames,this.tableConfiguration.list)}compile(){return this.setupHeader(),this.setup=this.getSetup(),this.setup.compile(this.element)}setupInitialSorting(t){var e,r,i,a,n;for(n=[],r=0,i=(a=this.tableConfiguration.columnConfigurations).length;r<i;r++)if((e=a[r]).initialSorting){if(!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,n.push(t.descending="desc"===e.initialSorting)}else n.push(void 0);return n}post(t,e,r,i){return this.setupInitialSorting(t),t.getSortIcon||(t.getSortIcon=function(e,r,i){return e!==t.predicate?"glyphicon glyphicon-minus":i?"glyphicon glyphicon-chevron-down":"glyphicon glyphicon-chevron-up"}),this.setup.link(t,e,r,i)}},e=class{constructor(t=0,e=1,r=0,i=1){if(this.lowerBound=t,this.upperBound=e,this.length=i,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";this.data=this.generate(r)}generate(t){var e,r,i,a,n;for(t>this.upperBound-this.length?t=this.upperBound-this.length:t<this.lowerBound&&(t=this.lowerBound),a=[],n=e=r=t,i=parseInt(t)+parseInt(this.length)-1;r<=i?e<=i:e>=i;n=r<=i?++e:--e)a.push(n);return a}resetParameters(t,e,r){if(this.lowerBound=t,this.upperBound=e,this.length=r,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";return this.data=this.generate(this.data[0])}relocate(t){var e;return e=this.data[0]+t,this.data=this.generate(e,e+this.length)}realignGreedy(t){var e;return t<this.data[0]?(e=t,this.data=this.generate(e)):t>this.data[this.length-1]?(e=t-(this.length-1),this.data=this.generate(e)):void 0}realignGenerous(t){}},u="<div style='margin: 0px;'> <ul class='pagination'> <li ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' ng-click='stepPage(-numberOfPages)'>{{getPaginatorLabels().first}}</a> </li> <li ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' ng-click='jumpBack()'>{{getPaginatorLabels().jumpBack}}</a> </li> <li ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' ng-click='stepPage(-1)'>{{getPaginatorLabels().stepBack}}</a> </li> <li ng-class='{active: getCurrentPage() == page}' ng-repeat='page in pageSequence.data'> <a href='' ng-click='goToPage(page)' ng-bind='page + 1'></a> </li> <li ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' ng-click='stepPage(1)'>{{getPaginatorLabels().stepAhead}}</a> </li> <li ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' ng-click='jumpAhead()'>{{getPaginatorLabels().jumpAhead}}</a> </li> <li ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' ng-click='stepPage(numberOfPages)'>{{getPaginatorLabels().last}}</a> </li> </ul> </div>",angular.module("angular-table").directive("atTable",["$filter",function(t){return{restrict:"AC",scope:!0,compile:function(e,r,i){var a,n,u;return u=new g(e,r),a=new o(r.atConfig),(n=new s(e,u,a)).compile(),{post:function(e,r,i){return n.post(e,r,i,t)}}}}}]),angular.module("angular-table").directive("atPagination",[function(){return{restrict:"E",scope:!0,replace:!0,template:u,link:function(t,r,a){var n,s,g,u,l,c;return n=new o(a.atConfig),c=new i(t,n,a.atList),g=function(t,e,r){return t=Math.max(e,t),Math.min(r,t)},s=function(){return t.numberOfPages},u=function(e){return t.numberOfPages=e},l=function(e){var r,i;if(c.getList())return c.getList().length>0?(r=Math.ceil(c.getList().length/c.getItemsPerPage()),u(r),i=t.showSectioning()?c.getMaxPages():r,t.pageSequence.resetParameters(0,r,i),c.setCurrentPage(g(c.getCurrentPage(),0,s()-1)),t.pageSequence.realignGreedy(c.getCurrentPage())):(u(1),t.pageSequence.resetParameters(0,1,1),c.setCurrentPage(0),t.pageSequence.realignGreedy(0))},t.showSectioning=function(){return c.getMaxPages()&&s()>c.getMaxPages()},t.getCurrentPage=function(){return c.getCurrentPage()},t.getPaginatorLabels=function(){return c.getPaginatorLabels()},t.stepPage=function(e){return e=parseInt(e),c.setCurrentPage(g(c.getCurrentPage()+e,0,s()-1)),t.pageSequence.realignGreedy(c.getCurrentPage())},t.goToPage=function(t){return c.setCurrentPage(t)},t.jumpBack=function(){return t.stepPage(-c.getMaxPages())},t.jumpAhead=function(){return t.stepPage(c.getMaxPages())},t.pageSequence=new e,t.$watch(n.itemsPerPage,function(){return l()}),t.$watch(n.maxPages,function(){return l()}),t.$watch(a.atList,function(){return l()}),t.$watch(`${a.atList}.length`,function(){return l()}),l()}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t,e,r){var i;if(!(i=t.attr("at-attribute")))throw`at-implicit specified without at-attribute: ${t.html()}`;return t.append(`<span ng-bind='item.${i}'></span>`)}}}])}).call(this);